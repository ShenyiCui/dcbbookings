<!DOCTYPE html>
<html>
	<head>
		<title>DCB BOOKINGS</title>
		<!--my own external stylesheets and JS-->
		<link href="CSS/main.css" rel="stylesheet">
		<script src="JS/main.js"></script>
		<script src="JS/GlobalStaticVars.js"></script>
		<!--Imported Stylesheets and JS-->
		<script src="JS/aws-cognito.js"></script>
		<script src="https://ajax.aspnetcdn.com/ajax/jQuery/jquery-3.4.0.min.js"></script>
		
	</head>
	
	<body style="margin:0;">
		<h1 align="center" id="mainTitle">DCB BOOKINGS</h1>
		
		<div class="box">
			<img id="landingImg" src="Images/LandingImg.jpg">
			<div class="text">
				<h1 id="LandingImgText">Welcome</h1>
				<button id="signInBtn" onClick="backToFirstSlide(); openSignInModal();" class="landingBtn" style="vertical-align:middle"><span>Make a Booking </span></button>
			</div>
		</div>

		<!-- Sign in Sign up Modal -->
        <div id="signInModal" class="Modal"> 
    	 	<!-- Modal content -->
      		<div class="signInModal-content"> <span class="Modalclose">&times;</span>	  	
        	  	<div class="SignUpSlideshow-container">
        	  	  <!--Sign in Slide <slide 1>-->
				  <div class="SignUpSlides">
					  <h1>Sign In</h1>
					  <p class="landingPageErrMsgs" id="LoginErrMsg"></p>
					  <hr>
					  <br><br><br>
					  <label for="email"><b>Email</b></label>
					  <input id="signInEmail" type="text" placeholder="Enter Email" name="email">
					  <label for="email"><b>Password</b></label>
					  <input id="signInPassword" type="password" placeholder="Enter Password" name="password">
					  <button class="LandingModalBtns" onClick="loginNow();">Sign In</button>
					  <a href="#" onClick="plusSlides(1); $('#SignupErrMsg1').html('');" id="SignUpNow">Sign Up</a>
					  <a href="#" onClick="currentSlide(4);" id="ForgotPass">Forgot Password</a>
				  </div>
				  <!--Sign up Slide 1 <slide 2>-->
				  <div class="SignUpSlides">
					  <img class="imgBtn" onClick="plusSlides(-1)" src="Images/Back.png" width="8%" style="margin: 0;"><h1 style="margin: 0;">Sign Up</h1>
					  <p class="landingPageErrMsgs" id="SignupErrMsg1"></p>
					  <hr>
					  <br><br>
				      <br>
					  <label for="email"><b>School Email</b></label>
					  <input id="SignUpEmail" type="text" placeholder="Enter Email" name="email">
					  <label for="email"><b>Password</b></label>
					  <input id="SignUpPass1" type="password" placeholder="Enter Password" name="password">
					  <label for="email"><b>Confirm Password</b></label>
					  <input id="SignUpPass2" type="password" placeholder="Enter Password" name="password">
					  <button class="LandingModalBtns" onClick="validifyPasswordEmailSignUp();">Next</button>
				  </div>
				  <!--Sign up Slide 2 <slide 3>-->
				  <div class="SignUpSlides">
			      	  <img class="imgBtn" onClick="plusSlides(-1)" src="Images/Back.png" width="8%" style="margin: 0;"><h1 style="margin: 0;">Sign Up</h1>
					  <p class="landingPageErrMsgs" id="SignupErrMsg2"></p>
					  <hr>
					  <br><br><br>
			      		<div class="custom-select">
							<select id="whoAreYouSelect">
								<option value="invalid">Who Are You:</option>
								<option value="Student">I am a Student</option>
								<option value="Teacher">I am a Teacher</option>
							</select>
				      	</div>
				      <br><br><br><br><br><br><br><br><br><br>
				      <button class="LandingModalBtns" onclick="validifyWhoYouAre()">Sign Up</button>
				  </div>
				  <!--forget password flow Slide 1 <side 4>-->
				  <div class="SignUpSlides">
			      	  <img class="imgBtn" onClick="currentSlide(1)" src="Images/Back.png" width="8%" style="margin: 0;"><h1 style="margin: 0;">Forgot Password</h1>
					  <p class="landingPageErrMsgs" id="ForgotPassErrMsg1"></p>
					  <hr>
					  <br><br><br>
			      	  <label for="email"><b>School Email</b></label>
					  <input id="ForgetPassEmail" type="text" placeholder="Enter Email" name="email">
				      <br><br><br><br><br><br><br><br><br>				      
				      <button class="LandingModalBtns" onClick="verifyNextForgetPass($('#ForgetPassEmail').val());">Next</button>
				  </div>
				  <!--forget password flow Slide 2 <side 5>-->
				  <div class="SignUpSlides">
			      	  <img class="imgBtn" onClick="plusSlides(-1)" src="Images/Back.png" width="8%" style="margin: 0;"><h1 style="margin: 0;">Forgot Password</h1>
					  <p class="landingPageErrMsgs" id="ForgotPassErrMsg2"></p>
					  <hr>
					  <br><br><br>
			      	  <label for="email"><b>Code Recieved In Email</b></label>
					  <input id="forgetPassCode" type="text" placeholder="Enter Code" name="Code">
			      	  <label for="Password1"><b>New Password</b></label>
					  <input id="forgetPassNPass" type="password" placeholder="Enter Code" name="Password1">
			      	  <label for="Password2"><b>Confirm New Password</b></label>
					  <input id="forgetPassNPassConfirm" type="password" placeholder="Enter Code" name="Password2">
				      <button onClick="verifyPasswordForgetPass($('#forgetPassCode').val(),$('#forgetPassNPass').val(),$('#forgetPassNPassConfirm').val())" class="LandingModalBtns">Change Password</button>
				  </div>
				</div>
          	</div>
          	
    	</div>
    	
	</body>
	
	
	<script>
		//modal Code LoginSignup
		var modal = document.getElementById("signInModal");

		// Get the <span> element that closes the modal
		var span = document.getElementsByClassName("Modalclose")[0];

		// When the user clicks the button, open the modal 
		function openSignInModal()
		{
			modal.style.display = "block";
		}

		// When the user clicks on <span> (x), close the modal
		span.onclick = function() {
		  modal.style.display = "none";
		}

		// When the user clicks anywhere outside of the modal, close it
		window.onclick = function(event) {
		  if (event.target == modal) {
			modal.style.display = "none";
		  }
		}
	</script>
	<script>//modal for Signups and Forget Password Slideshow
		var slideIndex = 1;
		showSlides(slideIndex);

		// Next/previous controls
		function plusSlides(n) 
		{
		  showSlides(slideIndex += n);
		}

		// Thumbnail image controls
		function currentSlide(n) 
		{
		  showSlides(slideIndex = n);
		}

		function showSlides(n) 
		{
		  var i;
		  var slides = document.getElementsByClassName("SignUpSlides");
		  if (n > slides.length) {slideIndex = 1} 
		  if (n < 1) {slideIndex = slides.length}
		  for (i = 0; i < slides.length; i++) {
			  slides[i].style.display = "none"; 
		  }
		  slides[slideIndex-1].style.display = "block"; 
		}
		function backToFirstSlide()
		{
			if(slideIndex!=1)
			{
				currentSlide(1);
			}
		}
	</script>
	<script>//custom select element code
		var x, i, j, selElmnt, a, b, c;
		/* Look for any elements with the class "custom-select": */
		x = document.getElementsByClassName("custom-select");
		for (i = 0; i < x.length; i++) {
		  selElmnt = x[i].getElementsByTagName("select")[0];
		  /* For each element, create a new DIV that will act as the selected item: */
		  a = document.createElement("DIV");
		  a.setAttribute("class", "select-selected");
		  a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
		  x[i].appendChild(a);
		  /* For each element, create a new DIV that will contain the option list: */
		  b = document.createElement("DIV");
		  b.setAttribute("class", "select-items select-hide");
		  for (j = 1; j < selElmnt.length; j++) {
			/* For each option in the original select element,
			create a new DIV that will act as an option item: */
			c = document.createElement("DIV");
			c.innerHTML = selElmnt.options[j].innerHTML;
			c.addEventListener("click", function(e) {
				/* When an item is clicked, update the original select box,
				and the selected item: */
				var y, i, k, s, h;
				s = this.parentNode.parentNode.getElementsByTagName("select")[0];
				h = this.parentNode.previousSibling;
				for (i = 0; i < s.length; i++) {
				  if (s.options[i].innerHTML == this.innerHTML) {
					s.selectedIndex = i;
					h.innerHTML = this.innerHTML;
					y = this.parentNode.getElementsByClassName("same-as-selected");
					for (k = 0; k < y.length; k++) {
					  y[k].removeAttribute("class");
					}
					this.setAttribute("class", "same-as-selected");
					break;
				  }
				}
				h.click();
			});
			b.appendChild(c);
		  }
		  x[i].appendChild(b);
		  a.addEventListener("click", function(e) {
			/* When the select box is clicked, close any other select boxes,
			and open/close the current select box: */
			e.stopPropagation();
			closeAllSelect(this);
			this.nextSibling.classList.toggle("select-hide");
			this.classList.toggle("select-arrow-active");
		  });
		}

		function closeAllSelect(elmnt) {
		  /* A function that will close all select boxes in the document,
		  except the current select box: */
		  var x, y, i, arrNo = [];
		  x = document.getElementsByClassName("select-items");
		  y = document.getElementsByClassName("select-selected");
		  for (i = 0; i < y.length; i++) {
			if (elmnt == y[i]) {
			  arrNo.push(i)
			} else {
			  y[i].classList.remove("select-arrow-active");
			}
		  }
		  for (i = 0; i < x.length; i++) {
			if (arrNo.indexOf(i)) {
			  x[i].classList.add("select-hide");
			}
		  }
		}

		/* If the user clicks anywhere outside the select box,
		then close all select boxes: */
		document.addEventListener("click", closeAllSelect);
	</script>
	<script>//Login Signup ForgetPass Logic, using script from main.js
		
		//Sign In Logic start -->
		var elem = document.getElementById("signInPassword");
		elem.onkeyup = function(e)//activate when enter key is pressed
		{
			if(e.keyCode == 13){
			   loginNow();
			}
		}
		function loginNow()//login Func, activates main Login in main.js
		{
			$("#LoginErrMsg").css("color","black");
			$("#LoginErrMsg").html("Logging on...");
			var userN = $("#signInEmail").val();
			var passW = $("#signInPassword").val();
			Login(userN,passW);
		}
		//Sign In Logic end -->
		
		
		//Sign Up Logic Start -->
		function validifyPasswordEmailSignUp()//first signup slide validification
		{
			if($("#SignUpEmail").val().indexOf("@dulwich-beijing.cn")<0) // does it contain the dulwich email
			{
				$("#SignupErrMsg1").css("color","red");
				$("#SignupErrMsg1").html("You must use a school email");
			}
			else if($("#SignUpPass1").val()!=$("#SignUpPass2").val()) // do the passwords match
			{
				$("#SignupErrMsg1").css("color","red");
				$("#SignupErrMsg1").html("Passwords do Not Match");
			}
			else // if everything works, move on
			{
				$("#SignupErrMsg1").css("color","black");
				$("#SignupErrMsg1").html("");
				plusSlides(1);
			}
		}
		$("#SignUpPass2").onkeyup = function(e)//activate when enter key is pressed
		{
			if(e.keyCode == 13){
			   validifyPasswordEmailSignUp();
			}
		}
		function validifyWhoYouAre()
		{
			if($("#whoAreYouSelect").val()!="invalid")
			{
				$("#SignupErrMsg2").css("color","black");
				$("#SignupErrMsg2").html("Signing Up...");
				createNewUser($("#SignUpEmail").val(),$("#SignUpPass1").val());
			}
			else
			{
				$("#SignupErrMsg2").css("color","red");
				$("#SignupErrMsg2").html("You Must Make a Selection Below");
			}
		}
		//Sign Up Logic End -->
		
		//forget Pass logic start -->
		function verifyNextForgetPass(email)
		{
			if(email.indexOf("@dulwich-beijing.cn")<0)
			{
				$("#ForgotPassErrMsg1").css("color","red");
				$("#ForgotPassErrMsg1").html("Your email must contain '@dulwich-beijing.cn'");
			}
			else
			{
				$("#ForgotPassErrMsg2").css("color","black");
				$("#ForgotPassErrMsg2").html("Verifying Email...");
				forgotPassword(email);
			}
		}
		$("#ForgetPassEmail").onkeyup = function(e)//activate when enter key is pressed
		{
			if(e.keyCode == 13){
			   verifyNextForgetPass($('#ForgetPassEmail').val());
			}
		}
		function verifyPasswordForgetPass(codez, password, cpassword)
		{
			if(password != cpassword)
			{
				$("#ForgotPassErrMsg2").css("color","red");
				$("#ForgotPassErrMsg2").html("Error, Passwords do not match");
			}
			else
			{
				$("#ForgotPassErrMsg2").css("color","black");
				$("#ForgotPassErrMsg2").html("Changing Password...");
				confirmForgottenPassword($('#ForgetPassEmail').val(),codez,password)
			}
		}
		$("#forgetPassNPassConfirm").onkeyup = function(e)//activate when enter key is pressed
		{
			if(e.keyCode == 13){
			   verifyPasswordForgetPass($('#forgetPassCode').val(),$('#forgetPassNPass').val(),$('#forgetPassNPassConfirm').val());
			}
		}
		//forget Pass logic end -->
	</script>
	
</html>
